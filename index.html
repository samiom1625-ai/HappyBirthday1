<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Happy Birthday, Aashika üéÇ</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />

  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet" />

  <style>
    :root {
      --bg1: #ff9a9e;
      --bg2: #fad0c4;
      --bg3: #fbc2eb;
      --bg4: #8ec5fc;
      --dark: #17152b;
      --accent1: #ffde59;
      --accent2: #ff7eb3;
      --accent3: #b5fffc;
      --card-bg: rgba(16, 16, 40, 0.9);
      --white: #ffffff;
      --shadow-soft: 0 18px 55px rgba(0, 0, 0, 0.55);
    }

    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: "Poppins", system-ui, -apple-system, BlinkMacSystemFont, sans-serif;
      min-height: 100vh;
      background:
        radial-gradient(circle at top left, var(--bg1), var(--bg3)),
        radial-gradient(circle at bottom right, var(--bg4), #19173a);
      background-blend-mode: screen;
      color: var(--white);
      display: flex;
      flex-direction: column;
      align-items: center;
      padding: 16px 10px 8px;
      overflow-x: hidden;
      overflow-y: auto;
      position: relative;
    }

    /* Soft blobs */
    body::before,
    body::after {
      content: "";
      position: fixed;
      width: 520px;
      height: 520px;
      border-radius: 50%;
      filter: blur(70px);
      opacity: 0.7;
      pointer-events: none;
      z-index: -2;
    }

    body::before {
      background: #ff9a9e;
      top: -140px;
      left: -130px;
      animation: blobMove1 24s alternate infinite ease-in-out;
    }

    body::after {
      background: #8ec5fc;
      bottom: -160px;
      right: -120px;
      animation: blobMove2 28s alternate infinite ease-in-out;
    }

    @keyframes blobMove1 {
      0%   { transform: translate(0, 0) scale(1); }
      50%  { transform: translate(80px, 140px) scale(1.14) rotate(8deg); }
      100% { transform: translate(120px, 40px) scale(1.05) rotate(-8deg); }
    }

    @keyframes blobMove2 {
      0%   { transform: translate(0, 0) scale(1); }
      50%  { transform: translate(-80px, -120px) scale(1.18) rotate(-7deg); }
      100% { transform: translate(-40px, 40px) scale(1.22) rotate(7deg); }
    }

    /* Confetti */
    #confettiCanvas {
      position: fixed;
      inset: 0;
      pointer-events: none;
      z-index: 4;
    }

    /* Floating bubbles */
    .bubbles {
      position: fixed;
      inset: 0;
      pointer-events: none;
      overflow: hidden;
      z-index: 0;
    }

    .bubbles span {
      position: absolute;
      border-radius: 50%;
      background: radial-gradient(circle at 30% 20%, rgba(255, 255, 255, 0.9), rgba(255, 255, 255, 0));
      border: 1px solid rgba(255, 255, 255, 0.25);
      opacity: 0.4;
      box-shadow: 0 0 20px rgba(255, 255, 255, 0.45);
      animation: floatBubble 18s linear infinite;
    }

    @keyframes floatBubble {
      0% {
        transform: translateY(110vh) scale(0.7);
        opacity: 0;
      }
      10% { opacity: 0.6; }
      100% {
        transform: translateY(-10vh) scale(1.1);
        opacity: 0;
      }
    }

    /* Watermark text */
    .watermark {
      position: fixed;
      inset: 0;
      pointer-events: none;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: clamp(2.8rem, 13vw, 6.4rem);
      font-weight: 700;
      letter-spacing: 0.35em;
      text-transform: uppercase;
      background: radial-gradient(circle, rgba(255, 255, 255, 0.7), rgba(255, 255, 255, 0));
      -webkit-background-clip: text;
      background-clip: text;
      -webkit-text-fill-color: transparent;
      opacity: 0.03;
      filter: blur(1px);
      z-index: 0;
      text-align: center;
      animation: watermarkPulse 12s ease-in-out infinite alternate;
    }

    @keyframes watermarkPulse {
      0%   { transform: scale(1) translateY(8px); opacity: 0.02; }
      100% { transform: scale(1.06) translateY(-8px); opacity: 0.06; }
    }

    /* Main layout */
    .shell {
      width: 100%;
      max-width: 1040px;
      z-index: 1;
    }

    .hero {
      display: grid;
      grid-template-columns: 1.3fr 1fr;
      gap: 20px;
      align-items: stretch;
    }

    @media (max-width: 850px) {
      .hero {
        grid-template-columns: 1fr;
      }
    }

    /* Envelope card */
    .envelope-card {
      background: linear-gradient(
          135deg,
          rgba(255, 255, 255, 0.16),
          rgba(255, 255, 255, 0.04)
        ),
        radial-gradient(circle at top left, rgba(255, 255, 255, 0.2), rgba(10, 10, 35, 0.96));
      border-radius: 26px;
      box-shadow: var(--shadow-soft);
      border: 1px solid rgba(255, 255, 255, 0.16);
      backdrop-filter: blur(18px) saturate(1.2);
      padding: 18px 18px 20px;
      position: relative;
      overflow: hidden;
      animation: slideUp 0.9s ease-out forwards;
    }

    @keyframes slideUp {
      from { opacity: 0; transform: translateY(30px) scale(0.97); }
      to   { opacity: 1; transform: translateY(0) scale(1); }
    }

    .label-line {
      display: inline-flex;
      align-items: center;
      gap: 8px;
      text-transform: uppercase;
      font-size: 0.7rem;
      letter-spacing: 0.18em;
      color: rgba(255, 255, 255, 0.78);
      margin-bottom: 10px;
    }

    .label-line::before {
      content: "";
      width: 36px;
      height: 2px;
      border-radius: 999px;
      background: linear-gradient(90deg, #ffeaa7, #ff8a5c);
      box-shadow: 0 0 8px rgba(255, 234, 167, 0.9);
    }

    .headline {
      font-size: clamp(2.1rem, 3vw, 2.8rem);
      font-weight: 700;
      line-height: 1.08;
      text-shadow:
        0 0 10px rgba(0, 0, 0, 0.45),
        0 0 22px rgba(255, 255, 255, 0.16);
      margin-bottom: 6px;
    }

    .headline span.name {
      background: linear-gradient(120deg, #ffde59, #ff9a62, #ffd5ff);
      -webkit-background-clip: text;
      background-clip: text;
      -webkit-text-fill-color: transparent;
      position: relative;
      padding-inline: 2px;
    }

    .headline span.name::after {
      content: "‚ú®";
      position: absolute;
      right: -1.2rem;
      top: -0.7rem;
      font-size: 1rem;
      animation: sparkleName 1.7s ease-in-out infinite alternate;
    }

    @keyframes sparkleName {
      0%   { transform: scale(0.8) rotate(0deg); opacity: 0.35; }
      100% { transform: scale(1.1) rotate(18deg); opacity: 1; }
    }

    .subtitle {
      font-size: 0.95rem;
      margin-bottom: 10px;
      color: rgba(255, 255, 255, 0.9);
    }

    .subtitle span {
      background: linear-gradient(110deg, #ffecd2, #fcb69f);
      -webkit-background-clip: text;
      background-clip: text;
      -webkit-text-fill-color: transparent;
      font-weight: 500;
    }

    .tiny-line {
      font-size: 0.86rem;
      line-height: 1.6;
      color: rgba(255, 255, 255, 0.86);
      margin-bottom: 14px;
    }

    .pill-row {
      display: flex;
      flex-wrap: wrap;
      gap: 7px;
      margin-bottom: 14px;
    }

    .pill {
      font-size: 0.76rem;
      padding: 5px 11px;
      border-radius: 999px;
      background: rgba(255, 255, 255, 0.06);
      border: 1px solid rgba(255, 255, 255, 0.2);
      display: inline-flex;
      align-items: center;
      gap: 6px;
      backdrop-filter: blur(10px);
    }

    .pill span.icon {
      font-size: 0.9rem;
    }

    /* Envelope graphic */
    .envelope-wrapper {
      margin-top: 10px;
      position: relative;
      height: 210px;
    }

    .envelope {
      position: absolute;
      inset: 0;
      margin: auto;
      width: 100%;
      max-width: 360px;
      height: 190px;
      transform-style: preserve-3d;
    }

    .envelope-base {
      position: absolute;
      inset: 0;
      background: linear-gradient(135deg, #ffe1e9, #ffd0ff);
      border-radius: 18px;
      box-shadow: 0 16px 32px rgba(0, 0, 0, 0.45);
      overflow: hidden;
    }

    .envelope-base::before {
      content: "";
      position: absolute;
      inset: 0;
      background:
        linear-gradient(135deg, rgba(255, 255, 255, 0.4), transparent 40%),
        radial-gradient(circle at bottom, rgba(255, 255, 255, 0.45), transparent 60%);
      opacity: 0.8;
      mix-blend-mode: screen;
    }

    .envelope-flap {
      position: absolute;
      top: 0;
      left: 50%;
      width: 110%;
      height: 70%;
      transform-origin: top center;
      transform: translateX(-50%) rotateX(0deg);
      background: linear-gradient(160deg, #ffb6c1, #ff7eb3);
      clip-path: polygon(0 0, 50% 86%, 100% 0);
      box-shadow: 0 12px 26px rgba(0, 0, 0, 0.35);
      transition: transform 0.8s cubic-bezier(0.16, 0.7, 0.2, 1.02);
      z-index: 2;
    }

    .page-letter {
      position: absolute;
      inset: 14px 14px auto 14px;
      height: 160px;
      background: #fffdf8;
      border-radius: 12px;
      box-shadow: 0 8px 24px rgba(0, 0, 0, 0.25);
      padding: 12px 16px;
      transform-origin: bottom center;
      transform: translateY(40px);
      transition: transform 0.9s cubic-bezier(0.16, 0.7, 0.2, 1.02);
      overflow: hidden;
    }

    .page-letter h2 {
      font-size: 0.9rem;
      text-transform: uppercase;
      letter-spacing: 0.15em;
      color: #ff7b89;
      margin-bottom: 6px;
    }

    .page-letter p {
      font-size: 0.8rem;
      line-height: 1.7;
      color: #5a4b47;
    }

    .page-letter .from {
      margin-top: 6px;
      font-size: 0.78rem;
      color: #9c7c70;
    }

    /* Letter content below envelope (hidden until open) */
    .letter-content {
      margin-top: 16px;
      padding-top: 12px;
      border-top: 1px dashed rgba(255, 255, 255, 0.2);
      font-size: 0.9rem;
      line-height: 1.8;
      color: rgba(255, 255, 255, 0.9);
      display: none;
      animation: fadeInUp 0.45s ease-out;
    }

    .letter-content.visible {
      display: block;
    }

    .letter-content .name {
      color: #ffd980;
      font-weight: 600;
    }

    .letter-content .wish-title {
      margin-top: 10px;
      font-weight: 600;
      color: #ffebb1;
    }

    .letter-content ul {
      margin: 6px 0 0 18px;
    }

    .letter-content li {
      margin-bottom: 5px;
    }

    @keyframes fadeInUp {
      from { opacity: 0; transform: translateY(6px); }
      to   { opacity: 1; transform: translateY(0); }
    }

    /* Button */
    .actions {
      margin-top: 10px;
      display: flex;
      align-items: center;
      gap: 10px;
      flex-wrap: wrap;
    }

    .btn-open {
      border: none;
      border-radius: 999px;
      padding: 9px 22px;
      font-size: 0.88rem;
      font-weight: 600;
      letter-spacing: 0.08em;
      text-transform: uppercase;
      cursor: pointer;
      display: inline-flex;
      align-items: center;
      gap: 8px;
      background: radial-gradient(circle at 0% 0%, #ffeaa7, #ff7eb3);
      color: #3e1135;
      box-shadow:
        0 14px 32px rgba(0, 0, 0, 0.55),
        0 0 0 1px rgba(255, 255, 255, 0.16);
      position: relative;
      overflow: hidden;
      transition:
        transform 0.16s ease-out,
        box-shadow 0.16s ease-out,
        filter 0.16s ease-out;
    }

    .btn-open::before {
      content: "";
      position: absolute;
      inset: 0;
      background: linear-gradient(120deg, rgba(255, 255, 255, 0.7), transparent 60%);
      transform: translateX(-140%);
      opacity: 0.7;
    }

    .btn-open span.text {
      position: relative;
      z-index: 1;
    }

    .btn-open:hover {
      transform: translateY(-1px) scale(1.03);
      box-shadow:
        0 18px 40px rgba(0, 0, 0, 0.6),
        0 0 0 1px rgba(255, 255, 255, 0.2);
      filter: brightness(1.05);
    }

    .btn-open:active {
      transform: translateY(1px) scale(0.97);
      box-shadow:
        0 12px 24px rgba(0, 0, 0, 0.6),
        0 0 0 1px rgba(255, 255, 255, 0.2);
    }

    .btn-open:hover::before {
      animation: shine 0.7s ease-out forwards;
    }

    @keyframes shine {
      0%   { transform: translateX(-140%); }
      100% { transform: translateX(140%); }
    }

    .hint {
      font-size: 0.72rem;
      opacity: 0.8;
    }

    /* RIGHT SIDE: Photo card */
    .photo-card {
      background: radial-gradient(circle at top, rgba(255, 255, 255, 0.12), rgba(16, 16, 40, 0.96));
      border-radius: 26px;
      box-shadow: var(--shadow-soft);
      border: 1px solid rgba(255, 255, 255, 0.16);
      padding: 18px 16px 18px;
      backdrop-filter: blur(18px) saturate(1.2);
      position: relative;
      overflow: hidden;
    }

    .photo-title {
      font-size: 0.86rem;
      text-transform: uppercase;
      letter-spacing: 0.16em;
      color: rgba(255, 255, 255, 0.82);
      margin-bottom: 6px;
    }

    .photo-caption {
      font-size: 0.86rem;
      color: rgba(255, 255, 255, 0.86);
      margin-bottom: 10px;
    }

    .photo-frame {
      position: relative;
      width: 100%;
      margin: 8px auto 4px;
      display: flex;
      justify-content: center;
    }

    .photo-circle {
      width: min(220px, 72vw);
      aspect-ratio: 1 / 1;
      border-radius: 50%;
      background: radial-gradient(circle at 30% 20%, rgba(255, 255, 255, 0.6), transparent 50%);
      box-shadow:
        0 18px 36px rgba(0, 0, 0, 0.55),
        0 0 0 2px rgba(255, 255, 255, 0.4);
      position: relative;
      overflow: hidden;
    }

    .photo-circle img {
      width: 100%;
      height: 100%;
      object-fit: cover;
      display: block;
      transform: scale(1.02);
    }

    .photo-placeholder {
      position: absolute;
      inset: 0;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 0.8rem;
      color: rgba(255, 255, 255, 0.9);
      text-align: center;
      padding: 0 18px;
      text-shadow: 0 0 9px rgba(0, 0, 0, 0.7);
      pointer-events: none;
    }

    .halo {
      position: absolute;
      inset: 10%;
      border-radius: 50%;
      border: 2px dashed rgba(255, 255, 255, 0.3);
      animation: spinHalo 14s linear infinite;
      pointer-events: none;
    }

    @keyframes spinHalo {
      from { transform: rotate(0deg); }
      to   { transform: rotate(360deg); }
    }

    .photo-note {
      font-size: 0.78rem;
      opacity: 0.82;
      text-align: center;
      margin-top: 8px;
    }

    .confetti-hint {
      position: absolute;
      bottom: 10px;
      right: 12px;
      font-size: 0.7rem;
      opacity: 0.65;
    }

    /* Little balloons on photo card */
    .mini-balloon {
      position: absolute;
      width: 32px;
      height: 40px;
      border-radius: 50% 50% 48% 48%;
      background: radial-gradient(circle at 30% 20%, rgba(255, 255, 255, 0.9), rgba(255, 180, 180, 0.95));
      box-shadow:
        0 8px 18px rgba(0, 0, 0, 0.3),
        inset 0 0 8px rgba(255, 255, 255, 0.7);
      transform-origin: bottom center;
      animation: miniFloat 9s ease-in-out infinite;
      opacity: 0.9;
    }

    .mini-balloon::after {
      content: "";
      position: absolute;
      bottom: -26px;
      left: 50%;
      width: 1.2px;
      height: 26px;
      transform: translateX(-50%);
      background: linear-gradient(180deg, rgba(255, 255, 255, 0.9), rgba(255, 255, 255, 0.2));
    }

    .mini-balloon.b-left {
      top: 34px;
      left: 10px;
      background: radial-gradient(circle at 30% 20%, #ffffff, #ff9a9e);
      animation-delay: -3s;
    }

    .mini-balloon.b-right {
      top: 70px;
      right: 8px;
      background: radial-gradient(circle at 30% 20%, #ffffff, #a18cd1);
      animation-delay: -6s;
    }

    @keyframes miniFloat {
      0%   { transform: translateX(0) translateY(0) rotate(-4deg); }
      25%  { transform: translateX(5px) translateY(-10px) rotate(4deg); }
      50%  { transform: translateX(-4px) translateY(-18px) rotate(-5deg); }
      75%  { transform: translateX(3px) translateY(-10px) rotate(3deg); }
      100% { transform: translateX(0) translateY(0) rotate(-3deg); }
    }

    /* Footer */
    .footer {
      width: 100%;
      text-align: center;
      font-size: 0.7rem;
      opacity: 0.35;
      letter-spacing: 0.12em;
      text-transform: uppercase;
      margin-top: 10px;
      z-index: 1;
    }

    .footer a {
      color: inherit;
      text-decoration: none;
      border-bottom: 1px dotted rgba(255, 255, 255, 0.25);
      padding-bottom: 1px;
      transition: opacity 0.2s ease, border-color 0.2s ease;
    }

    .footer a:hover {
      opacity: 0.8;
      border-color: rgba(255, 255, 255, 0.6);
    }

    /* Phone tweaks */
    @media (max-width: 720px) {
      body {
        padding-inline: 6px;
      }

      .envelope-wrapper {
        height: 200px;
      }

      .envelope {
        max-width: 320px;
        height: 180px;
      }

      .headline {
        font-size: 1.9rem;
      }

      .tiny-line,
      .letter-content {
        font-size: 0.88rem;
      }

      .photo-card {
        margin-top: 10px;
      }

      .footer {
        font-size: 0.64rem;
      }
    }

    /* When opened */
    .opened .envelope-flap {
      transform: translateX(-50%) rotateX(-125deg);
    }

    .opened .page-letter {
      transform: translateY(-40px);
    }
  </style>
</head>
<body>
  <canvas id="confettiCanvas"></canvas>

  <div class="bubbles" aria-hidden="true"></div>

  <div class="watermark" aria-hidden="true">Happy&nbsp;Birthday</div>

  <div class="shell">
    <div class="hero">
      <!-- LEFT: Envelope + Letter -->
      <div class="envelope-card" id="envelopeCard">
        <div class="label-line">A little birthday website for you</div>

        <h1 class="headline" id="headline">
          Happy Birthday,
          <span class="name">Aashika</span>
          ü•≥
        </h1>

        <p class="subtitle">
          Today is all about <span>your light, your laugh, your chaos and your magic</span>. üí´
        </p>

        <p class="tiny-line">
          I wanted to give you something that doesn‚Äôt vanish with a story or a chat ‚Äî
          so here‚Äôs a tiny corner of the internet that will always say:
          <strong>‚ÄúI‚Äôm so glad you exist.‚Äù</strong>
        </p>

        <div class="pill-row">
          <span class="pill"><span class="icon">üéÇ</span><span>More cake. Less worries.</span></span>
          <span class="pill"><span class="icon">‚ú®</span><span>Main-character year unlocked.</span></span>
          <span class="pill"><span class="icon">üéà</span><span>New memories loading‚Ä¶</span></span>
        </div>

        <div class="envelope-wrapper">
          <div class="envelope">
            <div class="envelope-base"></div>
            <div class="page-letter">
              <h2>To: Aashika</h2>
              <p>
                There‚Äôs a much longer message waiting for you below, but this part is simple:
                <br /><br />
                I hope this year brings you softness, loud laughs, quiet peace, and everything
                you secretly wished for when you closed your eyes over the candles.
              </p>
              <p class="from">From someone who‚Äôs really, really grateful for you üíå</p>
            </div>
            <div class="envelope-flap"></div>
          </div>
        </div>

        <div class="actions">
          <button class="btn-open" id="openBtn">
            <span class="text">Open Your Birthday Surprise</span>
            <span>üéâ</span>
          </button>
          <span class="hint">Tap once to open the envelope, show the full letter & confetti.</span>
        </div>

        <div class="letter-content" id="letterContent">
          Dear <span class="name">Aashika</span>,<br /><br />
          I hope today feels like a warm hug ‚Äî soft, bright and completely yours. The kind of day where your favourite
          song randomly plays, your cheeks hurt from smiling, and the universe quietly reminds you how precious you are. üíõ<br /><br />
          Thank you for being the kind of person who makes days lighter just by existing in them ‚Äî for your jokes, your chaos,
          your random thoughts, your sleepy rants, and all the tiny unfiltered parts of you that make life feel less boring.<br /><br />
          <span class="wish-title">For your new year, I wish you:</span>
          <ul>
            <li>‚ú® Mornings that feel gentle instead of heavy.</li>
            <li>üéß Nights filled with comfort shows, good songs and zero overthinking.</li>
            <li>üí´ People who choose you, respect you, and make you feel safe being yourself.</li>
            <li>üåà A future that turns out even more beautiful than the one you dream about when no one‚Äôs watching.</li>
          </ul>
          <br />
          No matter how loud or confusing life gets, I hope you never forget this ‚Äî you are worth good things, soft things,
          loud laughs, long hugs, and the kind of love that doesn‚Äôt make you shrink.<br /><br />
          <span class="name">Happy Birthday, Aashika. You deserve so much more than ‚Äújust‚Äù a wish. üíï</span>
        </div>
      </div>

      <!-- RIGHT: Photo + small stuff -->
      <div class="photo-card">
        <div class="photo-title">Your birthday spotlight</div>
        <p class="photo-caption">
          This space is for your favourite picture of you ‚Äî the one that captures your chaos, your smile,
          or just a moment that makes you feel like <strong>you</strong>.
        </p>

        <div class="photo-frame">
          <div class="photo-circle">
            <img src="./project/photo.jpg" alt="Your special photo" id="photoImg" />
            <div class="photo-placeholder" id="photoPlaceholder">
              Put a photo named <strong>photo.jpg</strong> inside the
              <br /><code>/project</code> folder to show it here. üíñ
            </div>
            <div class="halo"></div>
          </div>
        </div>

        <p class="photo-note">
          (Yes, this whole website is secretly built just to make you smile when you see this.)
        </p>

        <div class="mini-balloon b-left"></div>
        <div class="mini-balloon b-right"></div>

        <div class="confetti-hint">P.S. You can replay the confetti as many times as you want üéä</div>
      </div>
    </div>
  </div>

  <div class="footer">
    ¬© <a href="https://kushagrakumar.me" target="_blank" rel="noopener noreferrer">Kushagra Kumar</a>
  </div>

  <script>
    // Floating bubbles
    (function createBubbles() {
      const container = document.querySelector(".bubbles");
      const count = 30;
      for (let i = 0; i < count; i++) {
        const b = document.createElement("span");
        const size = 20 + Math.random() * 40;
        const delay = Math.random() * -20;
        const duration = 12 + Math.random() * 14;
        b.style.left = Math.random() * 100 + "vw";
        b.style.width = size + "px";
        b.style.height = size + "px";
        b.style.animationDelay = delay + "s";
        b.style.animationDuration = duration + "s";
        container.appendChild(b);
      }
    })();

    // Photo placeholder logic
    (function handlePhoto() {
      const img = document.getElementById("photoImg");
      const placeholder = document.getElementById("photoPlaceholder");
      img.addEventListener("load", () => {
        if (img.naturalWidth > 0) {
          placeholder.style.display = "none";
        }
      });
      img.addEventListener("error", () => {
        placeholder.style.display = "flex";
      });
    })();

    // Confetti system
    const Confetti = (function () {
      const canvas = document.getElementById("confettiCanvas");
      const ctx = canvas.getContext("2d");
      let width, height, particles = [], animationId = null;
      const colors = ["#ff9a9e", "#fad0c4", "#ffecd2", "#fcb69f", "#a18cd1", "#ffd180", "#b0eacd"];

      function resize() {
        width = window.innerWidth;
        height = window.innerHeight;
        canvas.width = width * window.devicePixelRatio;
        canvas.height = height * window.devicePixelRatio;
        ctx.setTransform(window.devicePixelRatio, 0, 0, window.devicePixelRatio, 0, 0);
      }

      function createParticles(count) {
        const arr = [];
        for (let i = 0; i < count; i++) {
          arr.push({
            x: Math.random() * width,
            y: Math.random() * -height,
            w: 6 + Math.random() * 6,
            h: 10 + Math.random() * 14,
            color: colors[Math.floor(Math.random() * colors.length)],
            speed: 3 + Math.random() * 4,
            tilt: Math.random() * 12 - 6,
            tiltSpeed: Math.random() * 0.08 + 0.02,
            angle: Math.random() * Math.PI * 2
          });
        }
        return arr;
      }

      function draw() {
        ctx.clearRect(0, 0, width, height);
        for (const p of particles) {
          ctx.save();
          ctx.translate(p.x, p.y);
          ctx.rotate(p.angle + p.tilt);
          ctx.fillStyle = p.color;
          ctx.fillRect(-p.w / 2, -p.h / 2, p.w, p.h);
          ctx.restore();
        }
      }

      function update() {
        for (const p of particles) {
          p.y += p.speed;
          p.x += Math.sin(p.angle) * 1.2;
          p.tilt += p.tiltSpeed;
          p.angle += 0.02;
          if (p.y > height + 40) {
            p.y = -20;
            p.x = Math.random() * width;
          }
        }
      }

      function loop() {
        draw();
        update();
        animationId = requestAnimationFrame(loop);
      }

      function start(durationMs = 7000) {
        resize();
        particles = createParticles(Math.floor(width / 9));
        cancelAnimationFrame(animationId);
        loop();
        setTimeout(stop, durationMs);
      }

      function stop() {
        cancelAnimationFrame(animationId);
        ctx.clearRect(0, 0, width, height);
      }

      window.addEventListener("resize", resize);
      resize();

      return { start, stop };
    })();

    // Envelope open + letter reveal + confetti
    (function setupOpenButton() {
      const openBtn = document.getElementById("openBtn");
      const envelopeCard = document.getElementById("envelopeCard");
      const letterContent = document.getElementById("letterContent");
      let opened = false;

      openBtn.addEventListener("click", () => {
        if (!opened) {
          opened = true;
          envelopeCard.classList.add("opened");
          letterContent.classList.add("visible");
          Confetti.start(9000);
          openBtn.querySelector(".text").textContent = "Replay the Confetti";
          envelopeCard.scrollIntoView({ behavior: "smooth", block: "center" });
        } else {
          Confetti.start(6000);
        }
      });
    })();
  </script>
</body>
</html>
